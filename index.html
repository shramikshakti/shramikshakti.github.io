<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Latest Posts</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 0;
            padding: 0;
        }

        .post {
            border-bottom: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 20px;
        }

        .post-preview {
            border: 1px solid #eee;
            padding: 10px;
            margin-bottom: 10px;
            background-color: #f9f9f9;
        }

        .post-preview a {
            display: inline-block;
            margin-top: 5px;
        }
    </style>
</head>
<body>

    <div class="container" id="postContainer">
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            function displayPosts(directory, containerId) {
                fetch(directory)
                    .then(response => response.text())
                    .then(data => {
                        const parser = new DOMParser();
                        const htmlDoc = parser.parseFromString(data, 'text/html');
                        const links = Array.from(htmlDoc.querySelectorAll('a'))
                            .filter(link => link.href.endsWith('.docx'))
                            .map(link => link.href);

                        const container = document.getElementById(containerId);
                        container.innerHTML = '';

                        links.forEach(link => {
                            const post = document.createElement('div');
                            post.classList.add('post');
                            const fileName = link.substring(link.lastIndexOf('/') + 1);

                            // Simulate fetching and processing the Word document (replace with actual logic)
                            simulateWordContent(link, fileName, post, link);

                            container.appendChild(post);
                        });
                    })
                    .catch(error => console.error('Error fetching posts:', error));
            }

            // Function to simulate fetching and processing Word document content
            function simulateWordContent(link, fileName, postElement, fullLink) {
                // In a real application, you would use a library or server-side code to extract text from Word documents.
                // This is a simplified simulation.
                fetch(link) // This will likely return an error.
                    .then(()=>{
                        const previewText = `This is a simulated preview of ${fileName}. In a real application, the text would be extracted from the Word document. Here would be about 80 words.`;
                        const preview = document.createElement('div');
                        preview.classList.add('post-preview');
                        preview.innerHTML = `<p>${previewText}</p><a href="${fullLink}" target="_blank">Read More</a>`;
                        postElement.innerHTML = `<h2>${fileName}</h2>`;
                        postElement.appendChild(preview);
                    })
                    .catch(()=>{
                        postElement.innerHTML = `<h2>${fileName}</h2><p>Unable to retrieve document preview.</p><a href="${fullLink}" target="_blank">Read More</a>`;
                    });

            }

            displayPosts('latest_post/', 'postContainer');
        });
    </script>
</body>
</html>
